<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrimeVision - AI-Powered Streaming Platform</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    


    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            overflow-x: hidden;
        }

        /* Align title and hide button horizontally */
        .title-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            width: 228.8px;
            /* Optional if you want to constrain width here */
            height: 32px;
            /* Maintain your fixed height */
            overflow: hidden;
        }

        /* Movie title styling */
        .movie-title1 {
            font-size: 20px;
            margin: 0;
            color: #fff;

            flex: 1 1 auto;
            /* Allow it to grow and shrink */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
            /* Required for ellipsis inside flex container */
        }

        /* Removed legacy hide/toggle UI styles */


        /* Navigation Bar */
        .navbar {
            position: fixed;
            top: 0;
            right: 0;
            left: 280px;
            height: 80px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(51, 224, 178, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 12px 50px 12px 20px;
            color: #ffffff;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #33E0B2;
            box-shadow: 0 0 0 3px rgba(51, 224, 178, 0.1);
        }

        .search-input::placeholder {
            color: #8892b0;
        }

        .search-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #8892b0;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .search-btn:hover {
            color: #33E0B2;
        }

        /* Search Results Dropdown */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(51, 224, 178, 0.2);
            border-radius: 12px;
            margin-top: 8px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .search-result-item {
            padding: 12px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .search-result-item:hover {
            background: rgba(51, 224, 178, 0.1);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-image {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            overflow: hidden;
        }

        .search-result-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .search-result-info h4 {
            color: #ffffff;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .search-result-info p {
            color: #8892b0;
            font-size: 0.8rem;
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .auth-btn {
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 0.9rem;
        }

        .signin-btn {
            background: transparent;
            color: #8892b0;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .signin-btn:hover {
            color: #33E0B2;
            border-color: #33E0B2;
        }

        .signup-btn {
            background: linear-gradient(135deg, #33E0B2, #2BC4A0);
            color: #ffffff;
        }

        .signup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(51, 224, 178, 0.3);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(20, 20, 35, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(51, 224, 178, 0.1);
            padding: 2rem 0;
            z-index: 101;
            transition: all 0.3s ease;
        }

        .logo-container {
            padding: 0 2rem 2rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        .logo-container h1 {
            color: #33E0B2;
            font-size: 1.8rem;
            font-weight: 700;
            text-shadow: 0 0 15px rgba(51, 224, 178, 0.3);
        }

        .logo-container p {
            color: #8892b0;
            font-size: 1.2rem;
            margin-top: 0.5rem;
        }

        .nav-menu {
            list-style: none;
            padding: 0 1rem;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            color: #8892b0;
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(51, 224, 178, 0.1);
            color: #33E0B2;
            transform: translateX(5px);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            margin-top: 80px;
            padding: 2rem;
            min-height: calc(100vh - 80px);
        }

        /* Hero Slider Section */
        .hero-section {
            position: relative;
            height: 500px;
            border-radius: 24px;
            margin-bottom: 3rem;
            overflow: hidden;
            border: 1px solid rgba(51, 224, 178, 0.2);
        }

        .hero-slider {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(51, 224, 178, 0.1) 0%, rgba(43, 196, 160, 0.05) 100%);
            display: flex;
            align-items: center;
            padding: 3rem;
            opacity: 0;
            /* Enhanced slide transitions with transform and improved easing */
            transform: translateX(100px);
            transition: all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            visibility: hidden;
        }

        .hero-slide.active {
            opacity: 1;
            transform: translateX(0);
            visibility: visible;
        }

        /* Added slide-out animation for smoother transitions */
        .hero-slide.slide-out {
            opacity: 0;
            transform: translateX(-100px);
            visibility: hidden;
        }

        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
            width: 100%;
        }

        /* Enhanced text animations with staggered entrance */
        .hero-text h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff, #33E0B2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-delay: 0.3s;
        }

        .hero-slide.active .hero-text h1 {
            transform: translateY(0);
            opacity: 1;
        }

        .hero-text p {
            font-size: 1.2rem;
            color: #8892b0;
            margin-bottom: 2rem;
            line-height: 1.6;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-delay: 0.5s;
        }

        .hero-slide.active .hero-text p {
            transform: translateY(0);
            opacity: 1;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-delay: 0.7s;
        }

        .hero-slide.active .hero-buttons {
            transform: translateY(0);
            opacity: 1;
        }

        .hero-btn {
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 600;
            text-decoration: none;
            /* Enhanced button transitions with smoother easing */
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            border: none;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        /* Added ripple effect for buttons */
        .hero-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .hero-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        /* Add to Favourites pill button */
        .add-fav-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            border-radius: 999px;
            border: 1px solid rgba(51,224,178,0.3);
            background: rgba(51,224,178,0.12);
            color: #33E0B2;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
        }
        .add-fav-pill:hover { transform: translateY(-2px); background: rgba(51,224,178,0.18); box-shadow: 0 8px 24px rgba(51,224,178,0.25); }
        .add-fav-pill svg { width: 18px; height: 18px; }
        .add-fav-pill.added { background: rgba(76, 217, 100, 0.18); color: #4CD964; border-color: rgba(76, 217, 100, 0.35); }
        .toast {
            position: fixed; top: 20px; right: 20px; z-index: 2000;
            background: linear-gradient(135deg, #33E0B2, #2BC4A0); color: #fff;
            padding: 12px 16px; border-radius: 10px; font-weight: 600;
            box-shadow: 0 12px 30px rgba(51,224,178,0.35); opacity: 0; transform: translateY(-10px);
            transition: opacity .2s ease, transform .2s ease;
        }

        .primary-btn {
            background: linear-gradient(135deg, #33E0B2, #2BC4A0);
            color: #ffffff;
        }

        .primary-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 20px 40px rgba(51, 224, 178, 0.4);
        }

        .secondary-btn {
            background: transparent;
            color: #8892b0;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .secondary-btn:hover {
            color: #33E0B2;
            border-color: #33E0B2;
            background: rgba(51, 224, 178, 0.1);
            transform: translateY(-2px);
        }

        .hero-image {
            position: relative;
            text-align: center;
            transform: translateX(50px);
            opacity: 0;
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-delay: 0.4s;
        }

        .hero-slide.active .hero-image {
            transform: translateX(0);
            opacity: 1;
        }

        .hero-character {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            /* Enhanced image hover with smoother scaling and glow effect */
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .hero-character:hover {
            transform: scale(1.08) rotateY(5deg);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4), 0 0 30px rgba(51, 224, 178, 0.2);
        }

        .toggle-desc-btn {
            background-color: #1A1A2EF2;
            color: #8892b0;
            border: none;
            /* padding: 8px 16px; */
            padding-top: 8px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            border-radius: 4px;
            user-select: none;
            transition: background-color 0.3s ease;
        }

        .toggle-desc-btn:hover {
            background-color: #1A1A2EF2;
        }

        .toggle-desc-btn .arrow {
            display: inline-block;
            margin-left: 8px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid #8892b0;
            transition: transform 0.3s ease;
        }

        /* Rotate arrow when active (description visible) */
        .toggle-desc-btn.active .arrow {
            transform: rotate(180deg);
        }

        /* Slider Navigation */
        .slider-nav {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .slider-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            /* Enhanced dot transitions with smoother scaling */
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }

        /* Added pulse animation for active dot */
        .slider-dot.active {
            background: #33E0B2;
            transform: scale(1.3);
            box-shadow: 0 0 15px rgba(51, 224, 178, 0.5);
        }

        .slider-dot.active::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border: 2px solid rgba(51, 224, 178, 0.3);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* Added pulse keyframe animation */
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        .slider-dot:hover {
            background: rgba(51, 224, 178, 0.7);
            transform: scale(1.2);
        }

        /* Content Sections */
        .content-section {
            margin-bottom: 3rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #ffffff;
        }

        .view-all {
            color: #33E0B2;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .view-all:hover {
            color: #2BC4A0;
            text-shadow: 0 0 8px rgba(51, 224, 178, 0.5);
        }

        /* Movie Cards Grid */
        .movies-grid {
            display: flex;
            gap: 2rem;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 1rem 0;
            scroll-behavior: smooth;
        }

        /* Custom scrollbar styling */
        .movies-grid::-webkit-scrollbar {
            height: 8px;
        }

        .movies-grid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .movies-grid::-webkit-scrollbar-thumb {
            background: #33E0B2;
            border-radius: 4px;
        }

        .movies-grid::-webkit-scrollbar-thumb:hover {
            background: #2BC4A0;
        }

        .movie-card {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid #33E0B2;
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            box-shadow:
                0 4px 15px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(51, 224, 178, 0.1);
            flex: 0 0 280px;
            /* Fixed width, no shrinking */
            min-width: 280px;
        }

        .movie-card:hover {
            transform: translateY(-10px);
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 0 20px rgba(51, 224, 178, 0.2);
        }

        /* Enhanced glow effect for movie cards */
        .movie-card:hover .movie-poster img {
            transform: scale(1.1);
        }

        .movie-poster {
            width: 100%;
            height: 200px;
            position: relative;
            overflow: hidden;
        }

        .movie-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .movie-card:hover .movie-poster img {
            transform: scale(1.1);
        }

        .movie-info {
            padding: 1.5rem;
        }

        .movie-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }

        .movie-genre {
            color: #8892b0;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .movie-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #33E0B2;
            font-weight: 500;
        }

        /* Continue Watching Section */
        .continue-watching {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .continue-card {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid #33E0B2;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            box-shadow:
                0 4px 15px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(51, 224, 178, 0.1);
        }

        .continue-card:hover {
            transform: translateY(-5px);
            box-shadow:
                0 15px 30px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(51, 224, 178, 0.2);
        }

        .continue-info {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .continue-poster {
            width: 80px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .continue-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .continue-details h4 {
            color: #ffffff;
            margin-bottom: 0.5rem;
        }

        .continue-details p {
            color: #8892b0;
            font-size: 0.9rem;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #33E0B2, #2BC4A0);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .navbar {
                left: 0;
            }

            .main-content {
                margin-left: 0;
            }

            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .hero-text h1 {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            .movies-grid {
                gap: 1rem;
            }

            .movie-card {
                flex: 0 0 250px;
                min-width: 250px;
            }

            .navbar {
                padding: 0 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .hero-section {
                height: 400px;
            }

            .hero-slide {
                padding: 2rem;
            }

            .hero-text h1 {
                font-size: 2rem;
            }

            .auth-buttons {
                gap: 0.5rem;
            }

            .auth-btn {
                padding: 8px 16px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .movie-card {
                flex: 0 0 200px;
                min-width: 200px;
            }

            .search-container {
                display: none;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: #8892b0;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            color: #33E0B2;
        }

        @media (max-width: 1024px) {
            .mobile-menu-toggle {
                display: block;
            }
        }

        /* Animations */
        /* Enhanced fadeInUp animation with better easing */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Added smooth entrance animation for movie cards */
        .movie-card {
            animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            opacity: 0;
        }

        .movie-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .movie-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .movie-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .movie-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        /* Removed all infinite slider CSS styles and restored original grid layout */

        /* Adjust grid for smaller screens */
        @media (max-width: 1200px) {
            .movies-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .continue-watching {
                grid-template-columns: 1fr;
                /* Stack on small mobile */
                gap: 1rem;
            }

            .continue-card {
                padding: 1rem;
            }

            .continue-details h4 {
                font-size: 1rem;
            }

            .continue-details p {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 0.5rem;
            }

            .hero-section {
                height: 350px;
                padding: 1rem;
            }

            .hero-slide {
                padding: 1.5rem;
            }

            .hero-text h1 {
                font-size: 1.8rem;
            }

            .hero-text p {
                font-size: 0.9rem;
                margin-bottom: 1rem;
            }

            .hero-buttons {
                flex-direction: column;
                gap: 0.8rem;
            }

            .hero-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .view-all {
                font-size: 0.9rem;
            }
        }

        .greeting-text {
            color: #8892b0;
            font-size: 1.2rem;
            font-weight: 500;
            margin-top: 0.3rem;
            margin-left: 2px;
            transition: color 0.3s ease;
        }

        /* New Trailer Popup Styles (Copied from trailers.html) */
        .trailer-popup-container {
            display: none;
            /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            padding: 20px;
            box-sizing: border-box;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            /* Default for larger screens */
        }

        .trailer-player-section {
            flex: 2;
            /* Takes more space */
            max-width: 60%;
            /* Max width for video */
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-right: 20px;
            /* Space between video and details */
        }

        .trailer-player-section iframe {
            width: 100%;
            height: 80vh;
            /* Responsive height */
            border-radius: 12px;
            border: 2px solid rgba(51, 224, 178, 0.4);
            box-shadow: 0 0 20px rgba(51, 224, 178, 0.5);
        }

        .movie-details-section {
            flex: 1;
            /* Takes less space */
            max-width: 40%;
            /* Max width for details */
            background: rgba(26, 26, 46, 0.95);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            overflow-y: auto;
            /* Enable scrolling for long descriptions */
            max-height: 80vh;
            /* Match video height */
        }

        .movie-details-section h2 {
            font-size: 2rem;
            color: #33E0B2;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(51, 224, 178, 0.3);
        }

        .movie-details-section p {
            font-size: 1rem;
            color: #b0b8c9;
            margin-bottom: 0.8rem;
            line-height: 1.5;
        }

        .movie-details-section p:last-of-type {
            margin-bottom: 0;
        }

        .close-popup-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2.5rem;
            color: #33E0B2;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.3s ease;
            z-index: 1001;
        }

        .close-popup-btn:hover {
            color: #2BC4A0;
            transform: rotate(90deg);
        }

        /* Responsive adjustments for the popup */
        @media (max-width: 1024px) {
            .trailer-popup-container {
                flex-direction: column;
                /* Stack vertically on smaller screens */
                padding: 15px;
            }

            .trailer-player-section {
                max-width: 100%;
                padding-right: 0;
                margin-bottom: 15px;
            }

            .trailer-player-section iframe {
                height: 50vh;
                /* Adjust height for mobile */
            }

            .movie-details-section {
                max-width: 100%;
                max-height: 40vh;
                /* Adjust height for mobile */
                padding: 1.5rem;
            }

            .movie-details-section h2 {
                font-size: 1.5rem;
            }

            .movie-details-section p {
                font-size: 0.9rem;
            }

            .close-popup-btn {
                font-size: 2rem;
                top: 10px;
                right: 10px;
            }
        }

        @media (max-width: 768px) {
            .trailer-player-section iframe {
                height: 40vh;
            }

            .movie-details-section {
                max-height: 35vh;
            }
        }

        @media (max-width: 480px) {
            .trailer-player-section iframe {
                height: 30vh;
            }

            .movie-details-section {
                max-height: 30vh;
                padding: 1rem;
            }

            .movie-details-section h2 {
                font-size: 1.2rem;
            }

            .movie-details-section p {
                font-size: 0.8rem;
            }
        }

        /* Added infinite slider styles */
        .greeting-text {
            color: #8892b0;
            font-size: 1.2rem;
            font-weight: 500;
            margin-top: 0.3rem;
            margin-left: 2px;
            transition: color 0.3s ease;
        }
    </style>
</head>

<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="logo-container">
            <h1>PrimeVision</h1>
            <p id="greeting" class="greeting-text"></p>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9,22 9,12 15,12 15,22" />
                    </svg>
                    Home
                </a>
            </li>
            <li class="nav-item">
                <a href="views/explore.html" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    Explore
                </a>
            </li>
            <li class="nav-item">
                <a href="views/favourites.html" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path
                            d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                    </svg>
                    Favourites
                </a>
            </li>
            <li class="nav-item">
                <a href="views/profile.html" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path
                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg>
                    Profile
                </a>
            </li>
            <li class="nav-item">
                <a href="views/subscription.html" class="nav-link">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82V9a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                    </svg>
                    Subscription
                </a>
            </li>
        </ul>
    </nav>
    <!-- Top Navigation Bar -->
    <header class="navbar">
        <button class="mobile-menu-toggle" id="mobileMenuToggle">â˜°</button>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="Search movies, shows, actors..." id="searchInput">
            <button class="search-btn" id="searchBtn">
                <svg width="20" height="20" viewBox="0 0 24  24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.35-4.35" />
                </svg>
            </button>
            <div class="search-results" id="searchResults"></div>
        </div>

        <div class="auth-buttons">
            <!--       <a href="views/login.html" class="auth-btn signin-btn">Sign In</a> -->
            <a href="views/login.html" class="auth-btn signup-btn">Sign Up</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Slider Section -->
        <section class="hero-section">
            <div class="hero-slider">
                <!-- Slide 1 - Stranger Things -->
                <div class="hero-slide active">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1>Stranger Things</h1>
                            <p>When a young boy vanishes, a small town uncovers a mystery involving secret experiments,
                                terrifying supernatural forces, and one strange little girl. Experience the supernatural
                                thriller that captivated millions worldwide.</p>
                            <div class="hero-buttons">
                                <a href="views/login.html" class="hero-btn primary-btn">Watch Now</a>
                                <a href="#" class="hero-btn secondary-btn">Add to List</a>
                            </div>
                        </div>
                        <div class="hero-image">
                            <img src="./images/stranger_things.jpg" alt="Stranger Things" class="hero-character">
                        </div>
                    </div>
                </div>

                <!-- Slide 2 - The Witcher -->
                <div class="hero-slide">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1>The Witcher</h1>
                            <p>Geralt of Rivia, a solitary monster hunter, struggles to find his place in a world where
                                people often prove more wicked than beasts. Follow the epic fantasy adventure based on
                                the bestselling novels.</p>
                            <div class="hero-buttons">
                                <a href="views/login.html" class="hero-btn primary-btn">Watch Now</a>
                                <a href="#" class="hero-btn secondary-btn">Add to List</a>
                            </div>
                        </div>
                        <div class="hero-image">
                            <img src="./images/witcher.webp" alt="The Witcher" class="hero-character">
                        </div>
                    </div>
                </div>

                <!-- Slide 3 - Breaking Bad -->
                <div class="hero-slide">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1>Breaking Bad</h1>
                            <p>A high school chemistry teacher diagnosed with inoperable lung cancer turns to
                                manufacturing and selling methamphetamine to secure his family's future. The critically
                                acclaimed crime drama that redefined television.</p>
                            <div class="hero-buttons">
                                <a href="views/login.html" class="hero-btn primary-btn">Watch Now</a>
                                <a href="#" class="hero-btn secondary-btn">Add to List</a>
                            </div>
                        </div>
                        <div class="hero-image">
                            <img src="./images/breakingbad.avif" alt="Breaking Bad" class="hero-character">
                        </div>
                    </div>
                </div>

                <!-- Slide 4 - The Mandalorian -->
                <div class="hero-slide">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1>The Mandalorian</h1>
                            <p>After the fall of the Galactic Empire, lawlessness has spread throughout the galaxy. A
                                lone gunfighter makes his way through the outer reaches, earning his keep as a bounty
                                hunter in the Star Wars universe.</p>
                            <div class="hero-buttons">
                                <a href="views/login.html" class="hero-btn primary-btn">Watch Now</a>
                                <a href="#" class="hero-btn secondary-btn">Add to List</a>
                            </div>
                        </div>
                        <div class="hero-image">
                            <img src="./images/mandalorian.jpg" alt="The Mandalorian" class="hero-character">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slider Navigation -->
            <div class="slider-nav">
                <div class="slider-dot active" data-slide="0"></div>
                <div class="slider-dot" data-slide="1"></div>
                <div class="slider-dot" data-slide="2"></div>
                <div class="slider-dot" data-slide="3"></div>
            </div>
        </section>

        <!-- Continue Watching Section -->
        <section class="content-section">
            <div class="section-header">
                <h2 class="section-title">Continue Watching</h2>
                <a href="#" class="view-all">View All</a>
            </div>
            <div class="continue-watching" id="continueWatchingContainer">
                <!-- Dynamic content will be loaded here -->
            </div>
        </section>

        <!-- You Might Like Section -->
        <section class="content-section">
            <div class="section-header">
                <h2 class="section-title">You might like</h2>
                <a href="#" class="view-all" id="viewAllYouMightLike">View All</a>
            </div>
            <!-- Replacing additional cards in You Might Like section with complete reference cards -->
            <div class="movies-grid" id="youMightLikeGrid"></div>
        </section>
        

        <!-- Popular Now Section -->
        <section class="content-section">
            <div class="section-header">
                <h2 class="section-title">Popular Now</h2>
                <a href="#" class="view-all">View All</a>
            </div>
            <div class="movies-grid" id="popularNowGrid"></div>
        </section>

        <!-- Recommendations Section -->
        <section class="content-section">
            <div class="section-header">
                <h2 class="section-title">Recommended For You</h2>
            </div>
            <div id="recommendations-container" class="recommendations-section">
                <div class="movies-grid" id="recommendationsGrid"></div>
                <p class="recommendation-prompt">Click on any movie to get personalized recommendations</p>
            </div>
        </section>
    </main>

    <!-- Added footer section matching homepage design -->
    <footer
        style="background: rgba(20, 20, 35, 0.95); border-top: 1px solid rgba(51, 224, 178, 0.1); padding: 3rem 2rem 2rem; margin-top: 4rem;">
        <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
            <div>
                <h3 style="color: #33E0B2; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">Company</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">About Us</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Careers</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Press</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Blog</a></li>
                </ul>
            </div>
            <div>
                <h3 style="color: #33E0B2; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">Support</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Help Center</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Contact Us</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Terms of
                            Service</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Privacy
                            Policy</a></li>
                </ul>
            </div>
            <div>
                <h3 style="color: #33E0B2; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">Features</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Premium</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Mobile App</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Downloads</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Gift Cards</a>
                    </li>
                </ul>
            </div>
            <div>
                <h3 style="color: #33E0B2; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem;">Connect</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Facebook</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Twitter</a></li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">Instagram</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;"><a href="#"
                            style="color: #8892b0; text-decoration: none; transition: color 0.3s ease;">YouTube</a></li>
                </ul>
            </div>
        </div>
        <div
            style="border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 2rem; text-align: center; color: #8892b0;">
            <p>&copy; 2024 PrimeVision. All rights reserved.</p>
        </div>
    </footer>

    <!-- New Trailer Popup (Moved from trailers.html) -->
    <div class="trailer-popup-container" id="trailerPopup">
        <span class="close-popup-btn" id="closePopup">&times;</span>
        <div class="trailer-player-section">
            <iframe id="trailerPlayer" src="about:blank" frameborder="0" allow="autoplay; encrypted-media"
                allowfullscreen></iframe>
        </div>
        <div class="movie-details-section">
            <h2 id="popupMovieTitle"></h2>
            <p id="popupMovieGenre"></p>
            <p id="popupMovieRating"></p>
            <p id="popupMovieDescription"></p>
        </div>
    </div>
    
    <script>
        // Add event listener for close button
        document.getElementById('closePopup').addEventListener('click', function() {
            const trailerPopup = document.getElementById('trailerPopup');
            const trailerPlayer = document.getElementById('trailerPlayer');
            
            // Hide the popup
            trailerPopup.style.display = 'none';
            
            // Reset the iframe src to stop video playback
            trailerPlayer.src = 'about:blank';
        });
    </script>

   
    <!-- Enhanced Chatbot Styles -->
    <style>
        /* Chatbot Toggle Button */
        .chatbot-toggle {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #33E0B2, #0ef5b5);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(51, 224, 178, 0.3);
            z-index: 2000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #1a1a2e;
            backdrop-filter: blur(10px);
        }

        .chatbot-toggle:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 12px 40px rgba(51, 224, 178, 0.4);
        }

        .chatbot-toggle:active {
            transform: translateY(0) scale(0.95);
        }

        /* Chatbot Window */
        .chatbot-window {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 380px;
            height: 600px;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(51, 224, 178, 0.2);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: none;
            flex-direction: column;
            z-index: 2000;
            overflow: hidden;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .chatbot-window.active {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        /* Chatbot Header */
        .chatbot-header {
            background: linear-gradient(135deg, #33E0B2, #0ef5b5);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #1a1a2e;
            font-weight: 600;
            font-size: 16px;
        }

        .chatbot-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #1a1a2e;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .chatbot-close:hover {
            background: rgba(26, 26, 46, 0.2);
            transform: scale(1.1);
        }

        /* Chat Messages Area */
        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chatbot-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chatbot-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .chatbot-messages::-webkit-scrollbar-thumb {
            background: rgba(51, 224, 178, 0.3);
            border-radius: 3px;
        }

        .chatbot-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(51, 224, 178, 0.5);
        }

        /* Message Bubbles */
        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.bot {
            background: linear-gradient(135deg, rgba(51, 224, 178, 0.2), rgba(14, 245, 181, 0.1));
            border: 1px solid rgba(51, 224, 178, 0.3);
            color: #ffffff;
            align-self: flex-start;
            border-bottom-left-radius: 6px;
        }

        .message.user {
            background: linear-gradient(135deg, #33E0B2, #0ef5b5);
            color: #1a1a2e;
            align-self: flex-end;
            border-bottom-right-radius: 6px;
            font-weight: 500;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: rgba(51, 224, 178, 0.1);
            border: 1px solid rgba(51, 224, 178, 0.2);
            border-radius: 18px;
            border-bottom-left-radius: 6px;
            padding: 12px 16px;
            max-width: 80px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: #33E0B2;
            border-radius: 50%;
            animation: typingDot 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingDot {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Quick Options */
        .chatbot-options {
            padding: 15px 20px;
            border-top: 1px solid rgba(51, 224, 178, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .option-btn {
            background: rgba(51, 224, 178, 0.1);
            border: 1px solid rgba(51, 224, 178, 0.3);
            color: #33E0B2;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .option-btn:hover {
            background: rgba(51, 224, 178, 0.2);
            transform: translateY(-1px);
        }

        /* Input Area */
        .chatbot-input-area {
            padding: 20px;
            border-top: 1px solid rgba(51, 224, 178, 0.1);
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .chatbot-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(51, 224, 178, 0.2);
            border-radius: 25px;
            padding: 12px 20px;
            color: #ffffff;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .chatbot-input:focus {
            border-color: #33E0B2;
            box-shadow: 0 0 0 3px rgba(51, 224, 178, 0.1);
        }

        .chatbot-input::placeholder {
            color: #8892b0;
        }

        .chatbot-send {
            background: linear-gradient(135deg, #33E0B2, #0ef5b5);
            border: none;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #1a1a2e;
            font-size: 16px;
        }

        .chatbot-send:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(51, 224, 178, 0.3);
        }

        .chatbot-send:active {
            transform: scale(0.95);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .chatbot-window {
                width: calc(100vw - 40px);
                height: calc(100vh - 120px);
                right: 20px;
                bottom: 80px;
            }
            
            .chatbot-toggle {
                right: 20px;
                bottom: 20px;
            }
        }
        .movie-card{
            position:relative;
        }
        .favourite-icon {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 36px;
    height: 36px;
    background-color: rgba(0, 0, 0, 0.6);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    z-index: 2; /* Make sure it's on top of the poster */
}

.favourite-icon:hover {
    transform: scale(1.1);
}

.favourite-icon svg {
    width: 20px;
    height: 20px;
    stroke: #ffffff; /* The outline of the heart */
    stroke-width: 2;
    fill: transparent; /* Makes the heart hollow by default */
    transition: all 0.2s ease-in-out;
}

/* This class will be added by JavaScript to make the heart red */
.favourite-icon.is-favourite svg {
    fill: #e50914;   /* Red fill when favourited */
    stroke: #e50914; /* Red outline when favourited */
}
    </style>

    <!-- Floating Chatbot Toggle -->
    <button id="chat-toggle" class="chatbot-toggle">
        ðŸ’¬
    </button>

    <!-- Chatbot Window -->
    <div id="chatbot" class="chatbot-window">
        <div class="chatbot-header">
            <div class="chatbot-title">
                <span>ðŸ¤–</span>
                <span>PrimeVision Assistant</span>
            </div>
            <button id="chat-close" class="chatbot-close">Ã—</button>
        </div>
        
        <div id="chatbox" class="chatbot-messages"></div>
        
        <div id="typing-indicator" class="typing-indicator">
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>
        
        <div id="options" class="chatbot-options"></div>
        
        <div class="chatbot-input-area">
            <input id="userInput" type="text" class="chatbot-input" placeholder="Type your message...">
            <button id="chatSend"class="chatbot-send">âž¤</button>
        </div>
    </div>
    <!-- ... your existing HTML and CSS ... -->
 <script>
    (function() {
        const favouritedShowIds = new Set();

        /**
         * Safely escapes a string to be used in HTML attributes.
         * @param {string} str The string to escape.
         * @returns {string} The escaped string.
         */
        function escapeHtml(str) {
            const p = document.createElement("p");
            p.textContent = str || '';
            return p.innerHTML;
        }

        /**
         * Creates the HTML for a single movie card, including all necessary data attributes.
         * @param {object} movie The movie data object from the API.
         * @returns {string} The HTML string for the movie card.
         */
        function createMovieCard(movie) {
            const isFavourited = favouritedShowIds.has(movie._id || movie.itemId);
            const movieId = movie._id || movie.itemId;
            const posterUrl = movie.poster_url || movie.posterUrl;
            const genres = Array.isArray(movie.genres) ? movie.genres.join(' â€¢ ') : '';
            
            return `
                <div class="movie-card" 
                    data-id="${movieId}" 
                    data-trailer="${movie.trailer_url || ''}" 
                    data-title="${escapeHtml(movie.title)}" 
                    data-genre="${escapeHtml(genres)}" 
                    data-rating="${movie.rating || 'N/A'}" 
                    data-description="${escapeHtml(movie.description || '')}">
                    
                    <div class="favourite-icon ${isFavourited ? 'is-favourite' : ''}" data-show-id="${movieId}">
                        <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    </div>
                    <div class="movie-poster">
                        <img src="${posterUrl}" alt="${movie.title}">
                    </div>
                    <div class="movie-info">
                        <h3 class="movie-title1">${movie.title}</h3>
                    </div>
                </div>`;
        }
        
        async function populateSection(endpoint, containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            try {
                const response = await fetch(`http://localhost:5000/api/shows/${endpoint}`);
                if (!response.ok) throw new Error('Network response was not ok');
                const movies = await response.json();
                container.innerHTML = movies.map(createMovieCard).join('');
            } catch (error) {
                container.innerHTML = `<p class="message">Could not load content.</p>`;
            }
        }
        
        async function fetchUserFavourites(userId, token) {
            try {
                const res = await fetch(`http://localhost:5000/api/users/me/favourites`, { headers: { 'Authorization': `Bearer ${token}` }});
                if (!res.ok) throw new Error('Failed to fetch favourites');
                const favourites = await res.json();
                favouritedShowIds.clear();
                for (const fav of favourites) {
                    if (fav && fav.itemId) favouritedShowIds.add(fav.itemId);
                }
            } catch (err) {
                console.error("Could not fetch user favourites:", err);
            }
        }

        function handleTrailerPopup(card) {
            const trailerPopup = document.getElementById("trailerPopup");
            const trailerPlayer = document.getElementById("trailerPlayer");
            
            // This now correctly sets the trailer URL from the data attribute
            const trailerSrc = card.getAttribute("data-trailer");
            trailerPlayer.src = trailerSrc ? `${trailerSrc}?autoplay=1` : 'about:blank';
            
            // This now populates all the detail fields in the popup using textContent to prevent HTML injection
            document.getElementById("popupMovieTitle").textContent = card.getAttribute("data-title");
            document.getElementById("popupMovieGenre").textContent = `Genre: ${card.getAttribute("data-genre")}`;
            document.getElementById("popupMovieRating").textContent = `Rating: â­ ${card.getAttribute("data-rating")}`;
            document.getElementById("popupMovieDescription").textContent = card.getAttribute("data-description") || "No description available.";
            
            trailerPopup.style.display = "flex";
        }

        async function handleFavouriteClick(icon, token) {
    const showId = icon.dataset.showId;
    const isFavourited = icon.classList.contains('is-favourite');
    const method = isFavourited ? 'DELETE' : 'POST';

    // --- THIS IS THE CORRECTED URL ---
    const url = isFavourited ? `http://localhost:5000/api/favourites/${showId}` : `http://localhost:5000/api/favourites`;

    try {
        const res = await fetch(url, {
            method,
            headers: { 
                'Content-Type': 'application/json', 
                'Authorization': `Bearer ${token}` 
            },
            body: isFavourited ? null : JSON.stringify({ showId: showId })
        });
        
        if (res.ok) {
            icon.classList.toggle('is-favourite');
        } else {
            const error = await res.json();
            alert(`Error: ${error.message || 'Failed to update favourites'}`);
        }
    } catch (err) {
        console.error("Failed to update favourite:", err);
    }
}
       async function generateAndSaveRecommendations(movieId, userId, token) {
    // Ensure the HTML container exists before proceeding.
    const recommendationsContainer = document.getElementById('recommendationsGrid');
    if (!recommendationsContainer) {
        console.error("Recommendation container '#recommendationsGrid' not found.");
        return;
    }

    // 1. Show a loading message to the user.
    recommendationsContainer.innerHTML = `<p class="message">Finding recommendations for you...</p>`;

    try {
        // 2. Fetch a new list of recommendations from the "Generator" API.
        const generateResponse = await fetch(`http://localhost:5000/api/shows/recommendations/${movieId}`);
        if (!generateResponse.ok) {
            throw new Error('Failed to generate new recommendations from the server.');
        }
        const recommendations = await generateResponse.json();

        // 3. Display the newly generated recommendations on the page.
        if (recommendations.length > 0) {
            recommendationsContainer.innerHTML = recommendations.map(createMovieCard).join('');
        } else {
            recommendationsContainer.innerHTML = `<p class="message">No specific recommendations found for this item.</p>`;
        }

        // 4. If the user is logged in, save these recommendations to their profile.
        if (userId && token && recommendations.length > 0) {
            console.log("User is logged in. Saving recommendations to the database...");
            
            // Prepare the list of just the movie IDs to save.
            const recommendationIds = recommendations.map(rec => rec._id);

            await fetch('http://localhost:5000/api/recommendations', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({
                    userId: userId,
                    sourceShowId: movieId,
                    recommendations: recommendationIds
                })
            });
            console.log("âœ… Recommendations saved successfully.");
        }

        // 5. Scroll the user to the recommendations section for a better experience.
        const recommendationsSection = document.querySelector('.recommendations-section');
        if (recommendationsSection) {
            recommendationsSection.scrollIntoView({ behavior: 'smooth' });
        }

    } catch (err) {
        console.error("Error in the recommendation process:", err);
        recommendationsContainer.innerHTML = `<p class="message">Could not load recommendations at this time.</p>`;
    }
}

        async function fetchSavedRecommendations(userId, token) {
    // The element ID in your previous code was 'recommendationsGrid'.
    // In our final plan, we used '#recommendations-container'. Please ensure this matches your HTML.
    const recommendationsContainer = document.getElementById('recommendationsGrid') || document.querySelector('#recommendations-container');
    if (!recommendationsContainer) return;

    try {
        // --- THIS IS THE CORRECTED FETCH CALL ---
        const res = await fetch(`http://localhost:5000/api/recommendations/${userId}`, { 
            headers: { 'Authorization': `Bearer ${token}` } 
        });

        if (!res.ok) return;

        // The API returns an object like { recommendations: [...] }
        const savedData = await res.json();

        // --- THIS LOGIC IS UPDATED TO HANDLE THE RESPONSE OBJECT ---
        if (savedData && savedData.recommendations && savedData.recommendations.length > 0) {
            // Hide the prompt to click a movie if saved recommendations exist
            const prompt = document.querySelector('.recommendation-prompt');
            if (prompt) prompt.style.display = 'none';
            
            // Map over the 'recommendations' array inside the response object
            recommendationsContainer.innerHTML = savedData.recommendations.map(createMovieCard).join('');
        }
    } catch (err) {
        console.error("Error fetching saved recommendations:", err);
    }
}

        /**
 * Clears user data from localStorage and redirects to the login page.
 */

function handleSignOut() {
    console.log("Signing out user...");
    localStorage.removeItem('auth_token');
    localStorage.removeItem('user_id');
    localStorage.removeItem('user_full_name');
    window.location.href = 'views/login.html';
}
/**
 * Displays the correct "Sign In" or "Sign Out" button based on token presence.
 */
function renderAuthButton(token) {
    const authContainer = document.querySelector('.auth-buttons');
    if (!authContainer) return;

    if (token) {
        authContainer.innerHTML = '<button class="auth-btn signup-btn" id="signOutBtn">Sign Out</button>';
        // --- THIS LINE IS NOW CORRECTED ---
        document.getElementById('signOutBtn').addEventListener('click', handleSignOut);
    } else {
        authContainer.innerHTML = '<a href="views/login.html" class="auth-btn signin-btn">Sign In</a>';
    }
}

        async function updateGreeting(token) {
            const greetingEl = document.getElementById('greeting');
            if (!greetingEl) return;
            const h = new Date().getHours();
            let timeOfDay = (h < 12) ? "Good Morning" : (h < 17) ? "Good Afternoon" : "Good Evening";
            if (!token) { greetingEl.textContent = `${timeOfDay}!`; return; }
            let fullName = localStorage.getItem('user_full_name');
            const firstName = fullName ? fullName.trim().split(' ')[0] : '';
            greetingEl.textContent = firstName ? `${timeOfDay}, ${firstName}!` : `${timeOfDay}!`;
            try {
                const res = await fetch('http://localhost:5000/api/users/me', { headers: { 'Authorization': `Bearer ${token}` } });
                if (res.ok) {
                    const { user } = await res.json();
                    if (user && user.fullName) {
                        localStorage.setItem('user_full_name', user.fullName);
                        const freshFirstName = user.fullName.trim().split(' ')[0];
                        greetingEl.textContent = `${freshFirstName ? `${timeOfDay}, ${freshFirstName}!` : `${timeOfDay}!`}`;
                    }
                }
            } catch (err) { console.error('Failed to fetch user name for greeting:', err); }
        }
         function setupChatbot() {
            const chatToggle = document.getElementById('chat-toggle');
            const chatWindow = document.getElementById('chatbot');
            const chatClose = document.getElementById('chat-close');
            const chatbox = document.getElementById('chatbox');
            const userInput = document.getElementById('userInput');
            const chatSend = document.getElementById('chatSend');
            const optionsContainer = document.getElementById('options');
            const typingIndicator = document.getElementById('typing-indicator');
            
            const addMessage = (sender, text) => {
                const messageEl = document.createElement('div');
                messageEl.classList.add('message', sender === 'PrimeVision Assistant' ? 'bot' : 'user');
                messageEl.textContent = text;
                chatbox.appendChild(messageEl);
                chatbox.scrollTop = chatbox.scrollHeight;
            };

            const showOptions = (options) => {
                optionsContainer.innerHTML = '';
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = opt.label;
                    btn.onclick = () => {
                        optionsContainer.innerHTML = ''; // Clear options after one is clicked
                        opt.action();
                    };
                    optionsContainer.appendChild(btn);
                });
            };
            
            const showTyping = () => typingIndicator.style.display = 'flex';
            const hideTyping = () => typingIndicator.style.display = 'none';

            const showPlans = () => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage("PrimeVision Assistant", "Here are our subscription plans:");
                    addMessage("PrimeVision Assistant", "âœ… Basic: â‚¹199/month â€“ 1 screen, SD quality");
                    addMessage("PrimeVision Assistant", "âœ… Standard: â‚¹499/month â€“ 2 screens, HD quality");
                    addMessage("PrimeVision Assistant", "âœ… Premium: â‚¹799/month â€“ 4 screens, Ultra HD quality");
                    showOptions([{ label: "â¬… Back to Menu", action: startChat }]);
                }, 1000);
            };
            
            const recommend = (category, movies) => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage("PrimeVision Assistant", `Top recommendations for ${category}: ${movies.join(", ")}`);
                    showOptions([{ label: "â¬… Back to Categories", action: showCategories }]);
                }, 1000);
            };

            const showCategories = () => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage("PrimeVision Assistant", "Choose a movie category:");
                    showOptions([
                        { label: "ðŸ’¥ Action", action: () => recommend("Action", ["John Wick", "Mad Max: Fury Road"]) },
                        { label: "ðŸ˜‚ Comedy", action: () => recommend("Comedy", ["The Hangover", "3 Idiots"]) },
                        { label: "ðŸ’• Romance", action: () => recommend("Romance", ["The Notebook", "La La Land"]) },
                        { label: "ðŸ‘» Horror", action: () => recommend("Horror", ["The Conjuring", "IT"]) },
                        { label: "ðŸš€ Sci-Fi", action: () => recommend("Sci-Fi", ["Interstellar", "Inception"]) },
                        { label: "â¬… Back to Menu", action: startChat }
                    ]);
                }, 800);
            };

            const showShows = () => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage("PrimeVision Assistant", "ðŸ“º Popular Shows: Stranger Things, Money Heist, The Witcher, Breaking Bad, Game of Thrones");
                    showOptions([{ label: "â¬… Back to Menu", action: startChat }]);
                }, 1000);
            };

            const showFeatures = () => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage("PrimeVision Assistant", "ðŸ“± App Features:\nâ€¢ Offline Downloads\nâ€¢ Multiple Device Support\nâ€¢ Parental Controls\nâ€¢ 4K Ultra HD Streaming");
                    showOptions([{ label: "â¬… Back to Menu", action: startChat }]);
                }, 1000);
            };

            const startChat = () => {
                chatbox.innerHTML = "";
                addMessage("PrimeVision Assistant", "ðŸ‘‹ Hi! I'm your PrimeVision assistant. How can I help you today?");
                setTimeout(() => {
                    showOptions([
                        { label: "ðŸ“Œ Subscription Plans", action: showPlans },
                        { label: "ðŸŽ¬ Movie Categories", action: showCategories },
                        { label: "ðŸ“º Popular Shows", action: showShows },
                        { label: "ðŸ“± App Features", action: showFeatures }
                    ]);
                }, 500);
            };

            const closeChat = () => {
                chatWindow.classList.remove("active");
                setTimeout(() => { chatWindow.style.display = "none"; }, 300);
            };

            const openChat = () => {
                chatWindow.style.display = "flex";
                setTimeout(() => { chatWindow.classList.add("active"); }, 10);
                startChat();
            };

            chatToggle.onclick = openChat;
            chatClose.onclick = closeChat;
            chatSend.onclick = () => { /* Basic send logic can be added here if needed */ };
            userInput.addEventListener("keypress", (e) => { if (e.key === "Enter") chatSend.onclick(); });
        }
      
       function createContinueWatchingCard(item) {
            return `
                <div class="continue-card movie-card" data-id="${item.itemId}">
                    <div class="continue-info">
                        <div class="continue-poster">
                            <img src="${item.posterUrl}" alt="${item.title}">
                        </div>
                        <div class="continue-details">
                            <h4>${item.title}</h4>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${item.progress || 50}%"></div>
                    </div>
                </div>`;
        }

       async function fetchContinueWatching(userId, token) {
    const container = document.getElementById('continueWatchingContainer');
    if (!container) return;

    try {
        const res = await fetch(`http://localhost:5000/api/watch-history/${userId}`, {
            headers: { 'Authorization': `Bearer ${token}` }
        });

        if (!res.ok) throw new Error('Failed to fetch continue watching list');
        
        const historyItems = await res.json();

        if (historyItems.length > 0) {
            // --- FIX #1: Use 'item.show' instead of 'item.showId' ---
            // The backend populates the movie data into the 'show' property.
            const movies = historyItems.map(item => item.show).filter(Boolean);
            
            // --- FIX #2: Use the universal 'createMovieCard' function for consistency ---
            container.innerHTML = movies.map(createMovieCard).join('');
        } else {
            container.innerHTML = '<p class="message">Start watching a show to see it here!</p>';
        }
    } catch (err) {
        console.error("Could not fetch continue watching list:", err);
        container.innerHTML = '<p class="message">Could not load your watch history.</p>';
    }
}

       async function logWatchHistory(movieId, userId, token) {
    // Stop if any required information is missing
    if (!movieId || !userId || !token) return;

    try {
        // --- THIS IS THE CORRECTED URL ---
        const res = await fetch('http://localhost:5000/api/watch-history', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}` 
            },
            body: JSON.stringify({ showId: movieId, userId: userId })
        });

        if (res.ok) {
            console.log(`Successfully logged watch history for movie: ${movieId}`);
        } else {
            // If the server response is not OK, log the error status
            console.error(`Failed to log watch history. Server responded with status: ${res.status}`);
        }

    } catch (err) {
        console.error("Failed to log watch history:", err);
    }
}


        // --- UPDATED MASTER CLICK HANDLER ---
        function masterClickHandler(event) {
            const favouriteIcon = event.target.closest('.favourite-icon');
            const movieCard = event.target.closest('.movie-card');

            if (favouriteIcon) {
                const token = localStorage.getItem('auth_token');
                if (!token) { alert('Please sign in to manage favourites.'); window.location.href = '/views/login.html'; return; }
                handleFavouriteClick(favouriteIcon, token);
            } else if (movieCard) {
                const movieId = movieCard.dataset.id;
                const token = localStorage.getItem('auth_token');
                 const userId = localStorage.getItem('user_id'); 
                // Log watch history when a card is clicked
                logWatchHistory(movieId, userId,token);
                
                if (movieId) generateAndSaveRecommendations(movieId, userId,token);
                handleTrailerPopup(movieCard);
            }
        }

        // --- UPDATED PAGE INITIALIZATION ---
       async function initializePage() {
            const token = localStorage.getItem('auth_token');
             const userId = localStorage.getItem('user_id');
            // --- THIS IS THE FIX ---
            // We now handle promises separately to prevent a single failure from stopping the others.

            // 1. Update UI elements that don't depend on each other.
            renderAuthButton(token);
            updateGreeting(token);
            setupChatbot();

            // 2. Fetch user-specific content. These can fail without stopping the page.
            if (token) {
                // We call these functions without 'await' in Promise.all so they run concurrently
                // but independently. An error in one will not stop the others.
                fetchUserFavourites(token);
                fetchSavedRecommendations(userId,token);
                fetchContinueWatching(userId,token);
            }

            // 3. Fetch public content. This will now run regardless of the user-specific fetches.
            await Promise.all([
                populateSection('popular', '#popularNowGrid'),
                populateSection('you-might-like', '#youMightLikeGrid')
            ]);
            
            // 4. Set up global event listeners.
            document.body.addEventListener('click', masterClickHandler);
            
            // Setup trailer popup close logic
            const trailerPopup = document.getElementById("trailerPopup");
            const closePopupBtn = document.getElementById("closePopup");
            const closePopup = () => {
                if(trailerPopup) trailerPopup.style.display = "none";
                const player = document.getElementById("trailerPlayer");
                if(player) player.src = "about:blank";
            };
            if(closePopupBtn) closePopupBtn.addEventListener("click", closePopup);
            if(trailerPopup) trailerPopup.addEventListener("click", (e) => { if(e.target === trailerPopup) closePopup(); });
            
            console.log("Page initialized with all features.");
        }

        document.addEventListener('DOMContentLoaded', initializePage);
    })();
    </script>


</body>


</html>